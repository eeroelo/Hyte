import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */const c=async(n,t={})=>{let e;try{const o=await fetch(n,t);if(!o.ok)throw new Error(`HTTP ${o.status} - ${o.statusText}`);e=await o.json()}catch(o){console.error("fetchData() error",o),e={}}return e},u=document.querySelector(".createuser");u.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt luodaan käyttäjä");const t="http://127.0.0.1:3000/api/users",e=document.querySelector(".create_user_form"),s={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value,email:e.querySelector("input[name=email]").value},r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};try{const a=await c(t,r);console.log(a)}catch(a){console.error(a)}});const i=document.querySelector(".loginuser");i.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt logataan sisään");const t="http://localhost:3000/api/auth/login",e=document.querySelector(".login_form"),o={username:e.querySelector("input[name=username]").value,password:e.querySelector("input[name=password]").value},s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)};c(t,s).then(r=>{console.log(r),console.log(r.token),localStorage.setItem("token",r.token),l("loginResponse",`localStorage set with token value: ${r.token}`),r.token==null?alert("Unauthorized: username or password incorrect!"):(alert("Authorized: you will now be redirected in 3 seconds"),setTimeout(function(){window.location.href="dashboard.html"},3e3))})});const m=document.querySelector(".createuser");m.addEventListener("click",async()=>{console.log("Testataan TOKENIA ja haetaan käyttäjän tiedot");const n="http://localhost:3000/api/auth/me",t=localStorage.getItem("token");console.log("Tämä on haettu LocalStoragesta",t);const e={method:"GET",headers:{Authorization:"Bearer: "+t}};console.log(e),c(n,e).then(o=>{console.log(o),l("meResponse",`Authorized user info: ${JSON.stringify(o)}`)})});const d=document.querySelector("#clearButton");d.addEventListener("click",p);function l(n,t){document.getElementById(n).innerText=t}function p(){localStorage.removeItem("token"),l("clearResponse","localStorage cleared!")}
